<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="referrer" content="same-origin">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Où c'est qu'on mange ?</title>

    <meta name="description" content=" ">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link crossorigin="anonymous" rel="stylesheet" href="https://rawgit.com/twbs/bootstrap/v4-dev/dist/css/bootstrap-reboot.css">

    <script defer crossorigin="anonymous" src="https://cdn.polyfill.io/v2/polyfill.min.js?features=default"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // save JSON URL in a const
            const jsonURL = 'https://raw.githubusercontent.com/newick/ou-cest-quon-bouffe/master/places.json'

            // create a request with fetch(), warning with browser compatibility
            // source https://developer.mozilla.org/fr/docs/Web/API/Fetch_API/Using_Fetch

            fetch(jsonURL)
                // get the response as in JSON format. Used arrow function instead of function()(https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Fonctions/Fonctions_fl%C3%A9ch%C3%A9es)
                // /*** old way ***\
                // .then(function (response) { 
                //     return response.json();
                // })
                .then(response => response.json())

                // console.log the results 
                .then(jsonRes => {
                    // let is used as a var usable only in this part (@David, isn't it?)
                    var data = jsonRes;
                    console.log(data);

                    // used for…of instead of for (var i = 0; i < data.length; i++)(https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Instructions/for...of)
                    for (let i of data) {
                        console.log("Nom :", i.name, " | Adresse :", i.address)
                    }

                    for (let j of data) {
                        var item = document.createElement("article");
                        var name = document.createElement("h2");
                        var address = document.createElement("address");
                        var placeName = j.name;
                        var placeAddress = j.address;
                        name.textContent = placeName;
                        address.textContent = placeAddress;

                        item.append(name, address)
                        list.append(item)
                    }
                })

            // // create a request with XMLHttpRequest()
            // // source: https://developer.mozilla.org/fr/docs/Learn/JavaScript/Objects/JSON
            // const request = new XMLHttpRequest();
            // // specify that we want to "get" the content and the location is specify in the const "json"
            // request.open("GET", jsonURL);
            // // specify the type of data waited, here json
            // request.responseType = "json";
            // // send the request
            // request.send();

            // // when the request's answer is received
            // request.onload = function () {
            //     // stocks the JSON in a const
            //     const places = request.response;
            //     console.log(places);

            //     // stock JSON detailed values in consts, just to console.log them
            //     for (var i = 0; i < places.length; i++) {
            //         const name = places[i].name;
            //         const address = places[i].address;
            //         console.log("Nom : " + name + ' | ' + "Adresse : " + address);
            //     }

            //     display(places);
            // }

            // function display(places) {
            //     // target the element ul named "list"
            //     const list = document.getElementById("list");

            //     // create a loop to add li elements in the list, inside them display places' name
            //     for (var j = 0; j < places.length; j++) {
            //         // create a new article element
            //         const item = document.createElement("article");
            //         // create a new h2 element
            //         const name = document.createElement("h2");
            //         // create a new address element
            //         const address = document.createElement("address");
            //         // stock places' name
            //         const placeName = places[j].name;
            //         // stock places' address
            //         const placeAddress = places[j].address;
            //         // specify that h2 has as a value place's name
            //         name.textContent = placeName;
            //         // specify that address has as a value place's address
            //         address.textContent = placeAddress;
            //         // insert in the article element the title and the address
            //         item.appendChild(name);
            //         item.appendChild(address);
            //         // insert in the section the article
            //         list.appendChild(item);
            //     }
            // }

        })

    </script>
</head>

<body>

    <section id="list"></section>

</body>

</html>